"0","#############################################################"
"0","##              TABELA RESUMO DOS RESULTADOS               ##"
"0","#############################################################"
"0",""
"0","# Função alternativa completamente nova para extrair dados do cld"
"0","extrair_dados_cld <- function(cld_obj) {"
"0","  # Converter para dataframe básico"
"0","  df <- as.data.frame(cld_obj)"
"0","  "
"0","  # Verificar e extrair as colunas necessárias com diferentes nomes possíveis"
"0","  tratamento <- if (""TRATAMENTO"" %in% names(df)) {"
"0","    as.character(df$TRATAMENTO)"
"0","  } else if (""treatment"" %in% names(df)) {"
"0","    as.character(df$treatment)"
"0","  } else if (""trt"" %in% names(df)) {"
"0","    as.character(df$trt)"
"0","  } else {"
"0","    as.character(rownames(df))"
"0","  }"
"0","  "
"0","  response <- if (""response"" %in% names(df)) {"
"0","    df$response"
"0","  } else if (""emmean"" %in% names(df)) {"
"0","    df$emmean"
"0","  } else if (""prob"" %in% names(df)) {"
"0","    df$prob"
"0","  } else {"
"0","    rep(NA, nrow(df))"
"0","  }"
"0","  "
"0","  group <- if ("".group"" %in% names(df)) {"
"0","    df$.group"
"0","  } else if (""group"" %in% names(df)) {"
"0","    df$group"
"0","  } else {"
"0","    rep("""", nrow(df))"
"0","  }"
"0","  "
"0","  # Criar dataframe diretamente sem usar select"
"0","  data.frame("
"0","    TRATAMENTO = tratamento,"
"0","    response = as.numeric(response),"
"0","    .group = as.character(group),"
"0","    stringsAsFactors = FALSE"
"0","  )"
"0","}"
"0",""
"0","# Criar tabela resumo sem usar select()"
"0","criar_tabela_final <- function() {"
"0","  # Extrair dados dos experimentos"
"0","  dados_exp1 <- extrair_dados_cld(resultados_exp1$cld) %>% "
"0","    mutate(Experimento = ""1"","
"0","           response = round(response, 2))"
"0","  "
"0","  dados_exp2 <- extrair_dados_cld(resultados_exp2$cld) %>% "
"0","    mutate(Experimento = ""2"","
"0","           response = round(response, 2))"
"0","  "
"0","  # Combinar e transformar os dados"
"0","  tabela <- bind_rows(dados_exp1, dados_exp2) %>% "
"0","    pivot_wider("
"0","      names_from = Experimento,"
"0","      values_from = c(response, .group),"
"0","      names_glue = ""Exp_{Experimento}_{.value}"""
"0","    )"
"0","  "
"0","  # Adicionar CVs como uma nova linha"
"0","  linha_cv <- data.frame("
"0","    TRATAMENTO = ""CV (%)"","
"0","    Exp_1_response = resultados_exp1$cv,"
"0","    Exp_2_response = resultados_exp2$cv,"
"0","    Exp_1_.group = """","
"0","    Exp_2_.group = """","
"0","    stringsAsFactors = FALSE"
"0","  )"
"0","  "
"0","  names(linha_cv) <- names(tabela) # Garantir mesmos nomes de colunas"
"0","  "
"0","  # Juntar tudo"
"0","  tabela_final <- bind_rows(tabela, linha_cv)"
"0","  "
"0","  # Renomear colunas manualmente"
"0","  colnames(tabela_final) <- c(""Tratamento"", "
"0","                             ""AACPD Exp 1"", ""Grupo Exp 1"", "
"0","                             ""AACPD Exp 2"", ""Grupo Exp 2"")"
"0","  "
"0","  return(tabela_final)"
"0","}"
"0",""
"0","# Gerar a tabela final"
"0","tabela_final <- criar_tabela_final()"
"0",""
"0","# Exibir tabela formatada"
"0","kable(tabela_final, align = ""c"") %>% "
"0","  kable_styling(full_width = FALSE) %>% "
"0","  add_header_above(c("" "" = 1, ""Experimento 1"" = 2, ""Experimento 2"" = 2)) %>% "
"0","  row_spec(nrow(tabela_final), bold = TRUE) %>% "
"0","  footnote(general = ""Médias seguidas pela mesma letra não diferem entre si pelo teste de Tukey (p < 0.05)"")"
