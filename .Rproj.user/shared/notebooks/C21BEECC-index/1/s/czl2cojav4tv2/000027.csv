"0",""
"0","# Decisão: Analisar experimentos separadamente devido à interação significativa"
"0","if (anova_interacao[""TRATAMENTO:REPETIÇÃO"", ""Pr(>F)""] < 0.05) {"
"0","  message(""Interação significativa encontrada. Analisando experimentos separadamente."")"
"0","} else {"
"0","  message(""Nenhuma interação significativa. Pode-se analisar os dados combinados."")"
"0","}"
"2","Interação significativa encontrada. Analisando experimentos separadamente.
"
"0","#############################################################"
"0","##         ANÁLISE INDIVIDUAL PARA CADA EXPERIMENTO       ##"
"0","#############################################################"
"0",""
"0","# Função para análise de um experimento específico"
"0","analisar_experimento <- function(dados_experimento, exp_id) {"
"0","  "
"0","  message(paste(""\nAnálise para o Experimento"", exp_id, ""\n""))"
"0","  "
"0","  # Modelo linear inicial"
"0","  modelo <- lm(audpc ~ TRATAMENTO + BLOCO,"
"0","               data = dados_experimento)"
"0","  "
"0","  # Verificação de pressupostos"
"0","  cat(""\nVerificação de pressupostos:\n"")"
"0","  teste_normalidade <- check_normality(modelo)"
"0","  print(teste_normalidade)"
"0","  "
"0","  # Modificação principal aqui: armazenar o p-value diretamente"
"0","  p_heteroced <- check_heteroscedasticity(modelo)"
"0","  cat(""Teste de heterocedasticidade - p-value:"", p_heteroced, ""\n"")"
"0","  "
"0","  # Plot de diagnósticos"
"0","  par(mfrow = c(1, 2))"
"0","  plot(residuals(modelo) ~ fitted(modelo), main = ""Resíduos vs Ajustados"")"
"0","  abline(h = 0, col = ""red"")"
"0","  qqnorm(residuals(modelo), main = ""Q-Q Plot dos Resíduos"")"
"0","  qqline(residuals(modelo), col = ""red"")"
"0","  par(mfrow = c(1, 1))"
"0","  "
"0","  # Transformação se necessário (testar logarítmica)"
"0","  if (p_heteroced < 0.05) {"
"0","    message(""Heterocedasticidade detectada (p = "", round(p_heteroced, 3), ""). Aplicando transformação logarítmica."")"
"0","    modelo <- lm(log(audpc) ~ TRATAMENTO + BLOCO,"
"0","                 data = dados_experimento)"
"0","    "
"0","    # Verificar pressupostos após transformação"
"0","    cat(""\nVerificação após transformação:\n"")"
"0","    print(check_normality(modelo))"
"0","    p_heteroced_pos <- check_heteroscedasticity(modelo)"
"0","    cat(""Teste de heterocedasticidade após transformação - p-value:"", p_heteroced_pos, ""\n"")"
"0","  }"
"0","  "
"0","  # ANOVA"
"0","  cat(""\nTabela ANOVA:\n"")"
"0","  anova_result <- anova(modelo)"
"0","  print(anova_result)"
"0","  "
"0","  # Comparação de médias (usando emmeans)"
"0","  medias <- emmeans(modelo, ~ TRATAMENTO, type = ""response"")"
"0","  "
"0","  # Letras de significância"
"0","  cld_result <- cld(medias,"
"0","                    Letters = letters,"
"0","                    adjust = ""tukey"")"
"0","  "
"0","  # Calcular CV"
"0","  cv <- agricolae::cv.model(modelo) %>% round(2)"
"0","  "
"0","  # Retornar resultados"
"0","  list("
"0","    modelo = modelo,"
"0","    anova = anova_result,"
"0","    medias = medias,"
"0","    cld = cld_result,"
"0","    cv = cv"
"0","  )"
"0","}"
"0",""
"0","# Aplicar análise para cada experimento"
"0","resultados_exp1 <- analisar_experimento(filter(PTD_3, REPETIÇÃO == 1), 1)"
"2","
Análise para o Experimento 1 

"
"1","
Verificação de pressupostos:
"
"1","[32mOK: residuals appear as normally distributed (p = 0.290).
[39m"
"1","Teste de heterocedasticidade - p-value:"
"1"," "
"1","0.01269094"
"1"," "
"1","
"
"1","
Verificação após transformação:
"
"1","[32mOK: residuals appear as normally distributed (p = 0.083).
[39m"
"1","Teste de heterocedasticidade após transformação - p-value:"
"1"," "
"1","0.587577"
"1"," "
"1","
"
"1","
Tabela ANOVA:
"
"1","Analysis of Variance Table
"
"1","
"
"1","Response: log(audpc)"
"1","
"
"1","          "
"1"," Df"
"1"," Sum Sq"
"1"," Mean Sq"
"1"," F value"
"1","    Pr(>F)"
"1","    "
"1","
TRATAMENTO"
"1","  5"
"1"," 6.5872"
"1"," 1.31745"
"1"," 52.3843"
"1"," 5.755e-09"
"1"," ***"
"1","
BLOCO     "
"1","  3"
"1"," 0.3937"
"1"," 0.13124"
"1","  5.2185"
"1","   0.01147"
"1"," *  "
"1","
Residuals "
"1"," 15"
"1"," 0.3772"
"1"," 0.02515"
"1","        "
"1","          "
"1","    "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
